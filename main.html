<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Main</title>
</head>
<body>
    <section class='sound_container'>
        <h1>Sound</h1>
    </section>
    <script>
    
    let requestURL = 'JSON/file.json';
    let section = document.querySelector('.sound_container');

    /*let request = new XMLHttpRequest(); //есть //создает запрос
    request.open('GET', requestURL); //done
    request.response = 'json';
    request.send();
    request.onload(()=>{
        let jsonObj = request.response;  //послу получение ответа запускаем функцию отрисовки
        showContent(jsonObj);
    });*/

    function makeRequest(method, url){ //функция, которая делает запрос на сервер. Ожидаем ответ
        return new Promise((resolve, reject) => {
            let xhr = new XMLHttpRequest();
            xhr.open(method, url);
            xhr.onload = ()=>{
                if(this.status < 300){
                    resolve(xhr.response);
                } else {
                    reject({
                        status: this.status,
                        statusText: xhr.statusText
                    })
                }
            }
            xhr.onerror = ()=> {
                reject({
                        status: this.status,
                        statusText: xhr.statusText
                }) 
            }
            xhr.send();
        })
    }
    async function asyncThing (){ //создаем запрос
        let jsonObj = await makeRequest('GET', requestURL);
        jsonObj = JSON.parse(jsonObj);
        showContent(jsonObj);
    }
    function showContent (obj){
       for(let i = 0; i < obj.length; i++){
            let holder = document.createElement('div');
            let name = document.createElement('span');
            let artist = document.createElement('span');
            let genre = document.createElement('span');

            name.textContent = obj[i].name;
            artist.textContent = obj[i].artist;
            genre.textContent = obj[i].genre;

            holder.appendChild(name);
            holder.appendChild(artist);
            holder.appendChild(genre);

            section.appendChild(holder);

       }

    }
    document.addEventListener('DOMContentLoaded', ()=>{
        asyncThing();
    })



     
     /*   let requesrURL = 'JSON/file.json';
        
       async function doAjaxThings() {
        // await code here
       let  jsonObj = await makeRequest("GET", requesrURL);
        // code below here will only execute when await makeRequest() finished loading
        //console.log(result);
        
}
document.addEventListener("DOMContentLoaded", function () {
    doAjaxThings();
    // create and manipulate your DOM here. doAjaxThings() will run asynchronously and not block your DOM rendering
    let container = document.querySelector('.sound_container');
    //let jsonObj = result;
    let text = document.createElement("p");
    text.textContent = jsonObj[name];
    container.appendChild(text);

    //document.getElementById("...").addEventListener(...);
});
function makeRequest(method, url) {
    return new Promise(function (resolve, reject) {
        let xhr = new XMLHttpRequest();
        xhr.open(method, url);
        xhr.onload = function () {
            if (this.status >= 200 && this.status < 300) {
                resolve(xhr.response);
            } else {
                reject({
                    status: this.status,
                    statusText: xhr.statusText
                });
            }
        };
        xhr.onerror = function () {
            reject({
                status: this.status,
                statusText: xhr.statusText
            });
        };
        xhr.send();
    });
}*/
       
    </script>

</body>
</html>